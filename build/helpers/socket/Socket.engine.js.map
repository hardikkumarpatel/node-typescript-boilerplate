{"version":3,"file":"Socket.engine.js","names":["_socket","require","_","asyncGeneratorStep","n","t","e","r","o","a","c","i","u","value","done","Promise","resolve","then","_asyncToGenerator","arguments","apply","_next","_throw","SocketEngineApp","constructor","http","IO","Server","cors","origin","connectionStateRecovery","allowEIO3","intiSocket","Log","info","on","_ref","socket","concat","id","reason","error","SocketException","Error","_x","emitSocketEvents","req","room","event","payload","app","get","in","emit","acknowledgment","callback","status","_default","exports","default"],"sources":["../../../src/helpers/socket/Socket.engine.ts"],"sourcesContent":["import HTTP from \"node:http\";\nimport { Request } from \"express\";\nimport { DisconnectReason, Server, Socket } from \"socket.io\";\nimport { Log } from \"@/helpers\";\n\nclass SocketEngineApp {\n    public static IO: Server;\n    constructor(http: HTTP.Server) {\n        SocketEngineApp.IO = new Server(http, {\n            cors: {\n                origin: '*'\n            },\n            connectionStateRecovery: {},\n            allowEIO3: true,\n        });\n        SocketEngineApp.intiSocket();\n    }\n\n    public static async intiSocket(): Promise<void> {\n        Log.info(`Socket app connected and initialized ðŸš€`);\n        SocketEngineApp.IO.on(\"connection\", async (socket: Socket) => {\n            try {\n                Log.info(`Socket is connected ${socket.id}`);\n\n                socket.on(\"disconnect\", (reason: DisconnectReason) => {\n                    Log.error<string>(`socket ${socket.id} disconnected due to`, reason)\n                });\n            } catch (SocketException: unknown) {\n                if (SocketException instanceof Error) {\n                    Log.error<Error>(\"Error ocurred in socket app\", SocketException)\n                }\n            }\n        })\n    }\n\n    public static async emitSocketEvents<T>(req: Request, room: string, event: string, payload: T): Promise<void> {\n        const IO: Server = req.app.get(\"IO\");\n        IO.in(room).emit(event, payload);\n    }\n\n    public static acknowledgment(callback?: (response: { status: string }) => void): void {\n        if (callback && typeof callback === \"function\") {\n            callback({ status: \"OK\" });\n        }\n    }\n}\n\nexport default SocketEngineApp;"],"mappings":"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","ignoreList":[]}